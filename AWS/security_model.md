### AWS 공유 책임 모델

- AWS 책임 - 클라우드에 대한 보안
  - 인프라에 대안 보호 (하드웨어, 소프트웨어, 퍼실리티, 네트워킹) 돌아가는 모든 것들
  - S3, DynamoDB, RDS 등에 대한 관리
- 고객 책임 - 클라우드 안에 있는 보안
  - EC2에서는 OS 패치, 보안그룹, IAM 퍼미션 등등
- 예
  - RDS
    - AWS
      - 언더라잉 EC2인스턴스 SSH 불가
      - 자동 DB 패치
      - OS 패치
      - 감사, 디스크 관리, 작동 관리 등
    - 고객
      - IP 포트 보안 그룹등
      - 유저 퍼미션
      - SSL 커넥션
      - 퍼블릭 엑세스 관리 등
      - 암호화 설정
  - S3
    - AWS
      - 무제한 스토리지
      - 보안 암호화
      - 다른 유저와 데이터 분리
      - 데이터에 내부자 접근 불가
    - 고객
      - 버킷 설정
      - 버킷 정책
      - IAM 유저 정책
      - 암호화 활성화 등

### DDOS 관련

- Shield
  - 스탠다드에서는 코스트 없이 DDOS 방어기능을 제공함
  - 어드밴스드에서는 24/7 DDOS 방어를 제공
- WAF
  - 웹에 특화된 방화벽
- CloudFront and Route 53
  - 가용성 방어 글로벌 엣지 네트워크를 이용
  - AWS Shield와 WAF를 이용해서 방어 결합
- 스케일링을 통해 방어할 수도 있음
- 스태틱 자료들은 S3이나 CloudFront를 통해서 전부 제공하고 동적인 부분만 직접 제공

### Shield

- 실드 스탠다드
  - 무료로 모든 유저에게 제공
  - SYN/UDP 플러딩이나 반사공격을 방어해줌 (3, 4계층)
- 실드 어드밴스드
  - DDOS 방어 특화 ($3,000)
  - 특정 타겟 공격을 방어해줌
  - 24/7 언제든 DDOS 방어팀에게 연결해줌
  - 방어시에 소요된 스케일링 비용 등을 전부 AWS에서 부담해줌

### WAF

- 일반적인 룰에 기반한 웹 공격 방어
- 보안 룰을 설정할 수 있음
  - 특정 트래픽에 대한 차단, 허용
  - IP주소 기반, 헤더 바디 주소 스트링 기반
  - 일반적인 SQL 인젝션이나 XSS 등등 방어 해줌
  - 봇이나 유저 agent 공격 등도 방어
  - 사이즈 기반
  - 지리기반
- CloudFront에 배포, ALB, API Gateway등에 배포 가능
- 마켓플레이스에 룰들이 존재하기 때문에 차용 가능

### AWS Inspector

- EC2 인스턴스에만 적용 가능
- 취약점 분석
- 의도하지 않은 네트워크노출 분석
- EC2 인스턴스에 에이전트가 설치되어야 함
- 템플릿을 지정하고
- AWS에서 지정한 템플릿만 이용 가능함
- 어떤것을 측정하나?
  - EC2에서만 유효
  - 네트워크 허용범위
  - 호스트 범위
    - 일반 취약점
    - CIS 벤치마크
    - 보안 모범사례
    - 런타임 분석

### Logging AWS

- 컴플라이언스를 충족하기 위해 AWS에서는 서비스 특정 감사 로그를 제공
- 서비스 로그는
  - CloudTrail trails - 모든 API 요청에 대한 추적
  - Config Rules - 설정과 컴플라이언스를 시간에 따라
  - CloudWatch Logs - 모든 데이터 퍼포먼스 로그
  - VPC Flow Logs - IP 트래픽과 VPC 내 로그
  - ELB Access Logs - 로드 밸런서에서 발생한 데이터 엑세스 등과 메타데이터
  - CloudFront Logs - 웹 요청에 대한 엑세스 로그
  - Waf Logs - 모든 차단 접속 로그
- 모든 로그는 아테나를 이용해서 S3에서 직접 분석할 수 있음
- S3 로그를 암호화 하고, 적절한 IAM 버킷 정책 , MFA등을 허용할 수 있음
- 로그의 비용 절감을 위해 글래시어 또한 활용 가능하다

### GuardDuty

- 지능 공격 탐지 툴
- 머신러닝 알고리즘을 이용
- 원클릭으로 30일간 사용 가능, 소프트웨어 인스톨도 불필요
- 인풋으로 활용할 수 있는것들
  - CloudTrail 로그
  - VPC Flow Logs
  - DNS Logs
