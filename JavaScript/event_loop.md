# Event Loop

## Event Loop에 대해서 어떤걸 배워야 하는지

- 프로세스와 쓰레드의 차이점
- 자바스크립트는 싱글 쓰레드인지 멀티 쓰레딩이 가능한지?
- 자바스크립트가 브라우저 위에서 어떻게 동작하는지
- 애니메이션을 줄 때 사용자 눈에 부드럽게 보이기 위해 60 frames per second 원칙에 대해서
- Task Queue, Microtask Queue의 차이점

## 프로세스와 쓰레드란 무엇인가?

### 프로세스

- 컴퓨터 (OS) 위에서 연속적으로 실행되고 있는 프로그램
  - 예를 들면, 사진을 보는 프로그램, 워드, 엑셀 등등
- 프로세스는 독립적으로 메모리 위에서 실행됨
- 프로세스에서 어떤 문제가 생긴다면 해당 프로세스만 종료됨 (강제 종료) → process is dead
- 각각의 프로세스는 저마다 자원이 정해져 있음
  1. 프로세스는 프로그램을 위한 코드가 들어있고
  2. 함수들이 어떤 순서로 실행되어야 하는지 들어있는 스택
  3. 오브젝트와 데이터를 생성할때 저장되는 공간인 힙
     - 힙에는 동적으로 할당되는 변수들이 할당됨
     - 데이터에는 전역 변수나 스태틱 변수들이 할당됨

### 쓰레드

- 프로세스 내부에서 작업 일부가 발생할 경우 처리하는 단위 (일꾼)
- 쓰레드들은 각각 처리해야 하는 함수의 호출 순서를 기억해야 하기 때문에 스택을 보유하고 있음
- 각각의 쓰레드들은 상호간의 처리해야 하는 내용 자체는 같기 때문에 아래와 같은 속성은 공통적으로 가지고 있음
  - 코드
  - 힙
  - 데이터
- 예를 들면, 동영상을 편집하는 프로세스에서
  1. 사진을 불러오고
  2. 음악을 불러오고
  3. 인코딩을 하는 등
- 각각의 작업이 발생하는데 해당 과정들을 복수의 쓰레드가 존재한다면 각각의 쓰레드들이 동시다발적으로 수행할 수 있음 → 프로세스의 효율화
- 만약, 쓰레드가 한개만 있다고 하면, 사진을 불러오는 동안 음악을 불러올 수 없는 등 한번에 하나의 일만 해야 함
- 쓰레드는 자신들이 일을 수행할 때 어디에서부터 어디까지 일을 했고 다음에는 어디인지 스택을 가지고 있지만, 공통적인 데이터 리소스는 프로세스에 있기 때문에 프로세스에 공통된 자원의 경우에는 동시다발적으로 접근하여 업데이트 하게 되는데, 멀티 쓰레딩이 어려운 이유가 여기에 있음

## 자바스크립트 런타임 환경 (엔진 이해, 스택 개념 정리)

- Java의 경우에는 언어 자체에서 멀티 쓰레딩이 지원됨
  - 프로그래머가 직접 특정 작업단위로 다른 쓰레드가 일을 하도록 지정할 수 있음
  - 총 몇개의 쓰레드가 동작할 수 있는지 지정 가능
- JavaScript의 경우에는 Single Threaded 언어
  - 언어 자체에서는 특정 쓰레드를 지정할 수 있는 방법이 없음
  - 단, JavaScript가 동작하고 있는 브라우저는 멀티 쓰레딩이 가능함 (Web APIs)
  - JavaScript가 동작하고 있는 Runtime Environment에서는 다른 방식을 이용해서 멀티 쓰레딩 효과를 얻을 수 있음
  - 뿐만 아니라 런타임에서는 이벤트 루프를 이용해서 다양한 동작을 실행할 수 있음
- JavaScript가 브라우저에서 동작하는 원리
  - JavaScript가 브라우저에 탑재되어 실행되면 JavaScript 엔진이 소스코드를 줄단위로 해석하고 실행함
    ```json
    Memory Heap
    ----
    변수를 선언해서 오브젝트를 할당하거나, 문자열, 숫자를 할당하면 힙에 저장됨
    구조적으로 정리된 자료구조가 아니고, 아무곳이나 저장되어 있음

    Call Stack
    ----
    함수를 실행하는 순서에 따라서 차곡 차곡 LIFO (Last In First Out) 형태로 쌓임

    ==========
    second()
    first()
    main()
    ==========

    push, pop 등이 지원되는 자료구조
    ```
    ```jsx
    function second() {
      console.log('hello');
      return;
    }
    function first() {
      second();
      return;
    }
    function main() {
      first();
      return;
    }
    main();
    ```
