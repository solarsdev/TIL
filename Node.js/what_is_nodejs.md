# Node.JS란 무엇인가?

## 노드는 무엇이고 어떻게 공부하는게 좋을까?

### 노드의 역사

- 1995년 자바스크립트가 도입이 되면서 자바스크립트 엔진을 브라우저들이 탑재하기 시작
  - Safari: JavaScriptCore
  - IE: Chakara
  - Firefox: SpiderMonkey
  - Chrome: V8 (JIT 지원)
  - Edge: Chakara → V8
- 2009년 라이언 달 JavaScript 런타임 환경인 Node를 개발
  - 브라우저 밖에서도 자바스크립트를 실행할 수 있도록 해주는 런타임 환경
- 브라우저에서의 JavaScript
  - Web Site
  - Web Application
- 런타임 환경에서의 JavaScript
  - Backend & Server
  - Front-end
  - Scripting & Automation
  - Server-side rendering
  - 기타 등등

### 공부방법

- Node에서 제공하는 기본 API를 익힌 뒤에, 노드를 이용해서 다양한 프로그램을 만들어보기
- 백엔드 지식을 쌓아가기, 기본기가 쌓이면 express, nest와 같은 프레임워크 사용해보기

## 노드를 배우면 좋은점들

### 왜 노드를 배워야 할까?

- 자바스크립트로 모든 것을 개발할 수 있음
  - 프론트엔드와 백엔드의 개발언어가 동일하기 때문에, 컨텍스트 스위칭이 덜함 (개발자 피로도 감소)
  - 프론트엔드 개발자의 지식을 그대로 흡수하여 백엔드 개발에 녹일 수 있음
- 많은 개발자들이 실제로 엔터프라이즈에서도 노드를 활용중에 있음
- 큰 기업들이 Node.js를 이용해서 서버를 구현하고 있음
  - Netflix, Uber, Ebay, PayPal, Reddit, Kakao, Naver 등
  - 커뮤니티가 형성되어 있음, Node.js로 증명된 프로덕트 퀄리티, 많은 툴이 이미 존재할 것임
- 간단하고 쉽지만, 강력하고 유연함
  - 러닝 커브가 높지 않은데, 생산성은 높음
  - 퍼포먼스가 좋음
- 강력한 커뮤니티가 존재
  - NPM을 이용해서 라이브러리를 사용 가능
  - 다양한 프로젝트의 템플릿이 제공됨

## Node의 중요한 특징 4가지

### JavaScript Runtime

- 웹 어셈블리와 에크마 스크립트에서 아용되고 있는 v8 엔진

### Single Thread

- OS에서 동시에 여러가지 프로그램을 실행하면 각 프로그램마다 프로세스가 할당됨
- 프로세스는 병렬적으로 동시에 수행되는 것 같지만, 실제로는 시간 할당을 이용하여 병렬처럼 보이는 것
- 프로세스의 영역을 4가지로 나누면 Code, Stack, Heap, Data 영역으로 나눌 수 있음
  - 이러한 리소스 영역과 작업을 수행하기 위해 각각의 작업마다 쓰레드를 나누어 할당할 수 있으며, 하나의 프로세서에서 여러개의 쓰레드가 동작하는 프로세스를 멀티 쓰레딩 프로세스라고 함
  - 멀티 쓰레딩을 지원하기 위해서는 여러가지 방법이 있지만, Java와 같은 프로그래밍 언어에서는 언어 자체적으로 멀티 쓰레딩을 지원하며, 이를 Concurrency API를 통해 제공하고 있음
  - 쓰레드가 무조건 많다고 좋은것은 아닌것이, 각각의 쓰레드가 공유하는 공유 리소스에 대한 접근, 어느 시간에 어떤 쓰레드를 실행할지에 대한 스케줄링에 오버헤드가 발생하기 때문에, 항상 많다고 좋은것은 아니지만 효율적이긴 함
  - 자바스크립트는 이러한 멀티 쓰레딩을 지원하지 않고 싱글 쓰레드로 동작하지만 Non-Blocking I/O와 Event-Driven 기능을 제공하여 퍼포먼스를 보장하고 있음

### Non-Blocking I/O

- I/O = Input/Output
- Blocking = 동기적인
- Non-Blocking = 비동기적인
- I/O를 수행할때 기다리지 않고 콜백으로 만들어 두고 수행하다가 콜백을 받으면 콜백을 수행

### Event-Driven

- 콜백을 만들고 적절한 시점에 콜백을 호출하는 이벤트 기반 방식이기 때문에 Event-Driven의 특징이 존재함

## 노드의 동작 방식은? 노드 내부 구조 살펴보기

- 노드를 실행하면 노드 어플리케이션 형태로 소스코드가 동작하게 됨
- 최초의 메인 함수를 수행할때 체이닝을 통해 여러가지 함수들이 연쇄적으로 수행되고, 최종적으로 메인이 종료되면 프로그램이 종료됨 (함수의 순서가 담기는 리소스를 콜스택, 동적으로 수행되면서 필요한 값을 담아두는 곳을 메모리 힙이라고 부름)
- 중간에 발생한 Non-Blocking I/O에서 실행된 함수는 콜백이 발생하는 시점에 TaskQueue에 로딩됨
- EventLoop는 콜스택이 비어있을 경우에 TaskQueue에 있는 함수를 콜스택으로 가져오는 역할을 함
- Node 자체는 메인 싱글 쓰레드로 동작하지만, 백그라운드 엔진은 C++, C로 작성된 라이브러리를 사용하기 때문에 백그라운드의 API는 멀티 쓰레딩이 가능
  - 따라서 메인 싱글 쓰레드 상에서 for loop등으로 이벤트 루프를 방해하는 것은 성능에 큰 영향을 줄 수 있음
  - Node 12부터는 worker threads를 이용할 수 있기 때문에 멀티 쓰레딩이 가능해짐

## 노드 서버의 특징

### Traditional Server

- 종래의 서버는 다양한 어플리케이션을 하나의 물리적 호스트에서 실행 혹은 나누어진 서버에서 실행할 수 있음
- 가령 웹 어플리케이션이 동작 중일때 쓰레드 풀이 한정되어 있고, 해당 쓰레드 풀이 비어 있을때만 요청을 처리할 수 있는 구조

### Node.js Server

- 노드는 메인 싱글 쓰레드가 블로킹 없이 요청의 전달자 역할을 수행
- 서버 어플리케이션의 처리 능력이 좋다면, 무제한으로 처리를 할 수 있게 됨
