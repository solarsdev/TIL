# 시스템 재부팅 및 종료

## 시스템 문제 시 재부팅?

### 운영중인 시스템의 재부팅

- 서비스 중단을 초래
- 근본적인 원인을 찾아야 함
  - 메모리 풀, 네트워크 소켓 수 등의 증가가 원인일 경우에는 단순히 재부팅으로는 해결되지 않음
- 시작 스크립트를 수정하거나 중요한 설정을 변경한 후에는 재부팅 하여 검증 필요
  - 몇 주가 지난 후 변경된 설정으로 인해 문제가 발생하는 경우 원인을 찾기 힘들어짐

### 물리 호스트 종료

- `halt`, `shutdown`(사용자에게 알림), `reboot` (재시작)
  ```bash
  sudo halt -p
  sudo shutdown -h now
  sudo reboot
  ```

### 클라우드 가상 머신 종료

- `halt`, `shutdown`, `reboot`
- 웹 콘솔, API 이용 (권장되지 않음, 물리 호스트의 전원을 끄는 것과 유사)
- 인스턴스 종료(`termination`)는 인스턴스를 삭제 (복구 불가)
  - 인스턴스 종료 방지 기능을 사용

### 부팅 실패한 시스템 복구 방법

- 디버깅 하지 않고 **백업에서부터 복구**
  - 클라우드에서 많이 사용되는 방법
- **디버깅 모드**로 시스템을 구동하여 복구
  - 단일 사용자 모드 (`single-user mode`), 복구 모드(`rescue mode`), 긴급 모드(`emergency mode`)를 사용하여 복구
  - 네트워크가 사용 불가능하기 때문에, 콘솔에 물리적인 접근이 필요
  - 클라우드에서는 사용이 힘든 점
    - (대안) EC2 직렬 콘솔 접근을 이용
- **복구 머신 이용**하여 복구
  - 다른 시스템 이미지로 부팅한 후 문제가 있는 시스템의 파일 시스템을 디버깅 서버에 마운트하여 사용
  - 클라우드 환경에서 많이 사용
